}
for (i in 150:196) {
s1 <- session(full_links[i])
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
download.file(frame_link1,method = "curl",destfile = basename(frame_link1))
}
for (i in 170:196) {
s1 <- session(full_links[i])
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
download.file(frame_link1,method = "curl",destfile = basename(frame_link1))
}
## Reading the PDFs
library(pdftools)
library(stringr)
## Reading the PDFs
library(pdftools)
library(stringr)
library(data.table)
## Read trial PDF
trial_pdf <- fread("CDSC_Data/Drug Alert Listnov21.pdf")
## Read trial PDF
trial_pdf <- "CDSC_Data/daaug18.pdf"
pdf_data(trial_pdf)
pdftools::pdf_text(trial_pdf)
pdftools::pdf_text(trial_pdf,sep="\n")
devtools::install(tabulizer)
devtools::install("tabulizer")
devtools::install.package("tabulizer")
install.packages("tabulizer")
install.packages("tabulizer")
if (!require("remotes")) {
install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")
# elsewhere
remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"))
install.packages("rJava")
library(rvest)
library(tidyverse)
my_url <- read_html("https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/")
full_links[12]
install.packages("rJava")
install.packages("rJava")
remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"))
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_attrs("dataTables_filter")
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("dataTables_filter")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("example_filter")
Search_links
full_links[13]
full_links[13]
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("input")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("input",type="text")
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes(input,"text")
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes(input)
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("search")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("input")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("input") %>%
.[[4]]
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("input",placeholder="drug alert")
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("label")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("[id='example_filer']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("[class='col-md-12 col-sm-12 table-responsive']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("[class='col-md-12 col-sm-12 table-responsive']") %>%
html_attr("type")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("[class='col-md-12 col-sm-12 table-responsive']") %>%
html_nodes("[class='dataTables_filter']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("[class='dataTables_filter']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attrs(id)
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attrs("id")
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attrs("class")
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attr("class")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attr("id")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attr("[id='wrapper']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_attr("[id='wrapper']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_node("input")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("div") %>%
html_nodes("input")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("section") %>%
html_nodes("input")
Search_links
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("section")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("section") %>%
html_attr("id=['printableArea']")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("section") %>%
.[[1]]
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("section") %>%
.[[1]] %>% html_nodes("input")
Search_links
Search_links <- "https://cdsco.gov.in/opencms/opencms/en/Notifications/Alerts/" %>%
read_html() %>%
html_nodes("section") %>%
.[[1]]
Search_links
setwd("CDSC_Data/")
for (i in 1:50) {
s1 <- session(full_links[i])
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
download.file(frame_link1,method = "curl",destfile = basename(frame_link1))
}
for (i in 51:100) {
s1 <- session(full_links[i])
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
download.file(frame_link1,method = "curl",destfile = basename(frame_link1))
}
for (i in 101:150) {
s1 <- session(full_links[i])
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
download.file(frame_link1,method = "curl",destfile = basename(frame_link1))
}
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
for (i in 151:196) {
s1 <- session(full_links[i])
frame_link1 <- s1%>%read_html%>%html_nodes("iframe") %>%
html_attr("src")%>%{paste0("https://cdsco.gov.in", .)}
download.file(frame_link1,method = "curl",destfile = basename(frame_link1))
}
trial_pdf <- "CDSC_Data/daaug18.pdf"
library(tabulizer)
out1 <- extract_tables(trial_pdf)
trial_pdf <- "daaugt15.pdf"
out1 <- extract_tables(trial_pdf)
out1
as.data.frame(out1)
out1
df <- as.data.frame(out1)
df$X1
df
df$X2
df$X3
df$X2
df$X3
df
length(df$X5)
length(df$X2)
length(df$X1)
library(tabulizer)
## Reading the PDFs
library(pdftools)
library(stringr)
library(data.table)
library(tabulizer)
out1 <- extract_tables(trial_pdf,output = "data.frame",method = "lattice")
trial_pdf <- "daaugt15.pdf"
out1 <- extract_tables(trial_pdf,output = "data.frame",method = "lattice")
trial_pdf <- "CDSC_Data/daaugt15.pdf"
out1 <- extract_tables(trial_pdf,output = "data.frame",method = "lattice")
out1 <- extract_tables(trial_pdf,output = "data.frame",method = "lattice")
trial_pdf <- "CDSC_Data/dasept14.pdf"
out1 <- extract_tables(trial_pdf,output = "data.frame",method = "lattice")
out1 <- extract_tables(trial_pdf)
df <- as.data.frame(out1)
df
df[12]
df[,12]
df[12,]
df[22,]
df[1,]
df[2,]
renames <- function(x){
colnames(x) <- x[1,]
x <- x[2:dim(x)[1],,drop=F]
return(as.data.frame(x))
}
df21 <- lapply(out1,renames)
df <- do.call(rbind,df21)
df21
names(df21)
names(df)
df1 <- do.call(rbind,df21)
names(df21[[1]])
names(df21[[2]])
df21[[2]]
names(df[[2:7]]) <- names(df[[1]])
names(df[[2]]) <- names(df[[1]])
names(df[[2]])
names(df[[1]])
df21 <- lapply(out1,renames)
df1 <- do.call(rbind,df21)
df1 <- rbind(df21,setnames(rev(df21)),names(df21))
df21 <- as.data.frame(df21)
# df21 <- as.data.frame(df21)
df1 <- rbindlist(df21)
typeof(df21)
# df21 <- as.data.frame(df21)
df1 <- rbindlist(df21,names="FALSE")
# df21 <- as.data.frame(df21)
df1 <- rbindlist(df21,names=FALSE)
# df21 <- as.data.frame(df21)
df1 <- rbindlist(df21,fill = TRUE)
df1
# df21 <- as.data.frame(df21)
df1 <- rbindlist(df21,use.names = FALSE)
df1
trial_pdf <- "CDSC_Data/danov13.pdf"
out1 <- extract_tables(trial_pdf)
df <- as.data.frame(out1)
out1
out1 <- extract_tables(trial_pdf,output = "data.frame")
out1 <- extract_tables(trial_pdf,output = "data.frame",header="TRUE")
## Rename files in bulk in a folder
folder = "CDSC_Data/"
files <- list.files(folder,pattern = "da*.pdf",full.names = T)
files
files <- list.files(folder,pattern = "Drug Alert*.pdf",full.names = T)
files
files <- list.files(folder,pattern = "damar*.pdf",full.names = T)
files
files <- list.files(folder,pattern = "*.pdf",full.names = T)
files
files[7:70]
files[7:73]
files[7:74]
files[7:73]
files[6:73]
files[7:73]
## Rename files in bulk in a folder
library(pdftools)
pdftools::pdf_info(files[7])
pdftools::pdf_info(files[71])
pdftools::pdf_info(files[23])
pdftools::pdf_info(files[26])
library(dplyr)
names(file) <- basename(files)
names(files)
names(files[12])
files <- list.files(folder,pattern = "*.pdf",full.names = T)
basename(files[12])
typeof(basename(files[12]))
basename(files)
pdftools::pdf_data(files[8])
pdftools::pdf_data(files[8])$text
data1 <- pdf_data(files[8])
data1
data1[[1]]$text
data1 <- pdf_data(files[7])
data1[[1]]$text
data1[[1]]$text[1:10]
for (i in 7:73){
print(pdf_data[i][[1]]$text[1:10])
}
for (i in 7:73){
print(pdf_data(files[i])[i][[1]]$text[1:10])
}
for (i in 7:73){
print(pdf_data(files[i])[[1]]$text[1:10])
}
print(pdf_data(files[i])[[1]]$text[1:15])
for (i in 7:73){
print(pdf_data(files[i])[[1]]$text[1:15])
}
head_data <- pdf_data(files[i])[[1]]$text
head_data
head_data <- pdf_data(files[i])[[1]]$text[1:30]
head_data
which(head_data=="Month")
for (i in 7:73){
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data=="Month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
Year_data=NULL
for (i in 7:73){
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data=="Month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
for (i in 7:73){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data=="Month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
head_data
for (i in 7:73){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
head_data
i
file[38]
files[38]
files <- list.files(folder,pattern = "*.pdf",full.names = T)
for (i in 7:72){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
Year_data
data1 <- pdf_data(files[7])
data1[[1]]$text[1:10]
data1[[1]]$text[1:30]
data1 <- pdf_data(files[13])
data1[[1]]$text[1:30]
Year_data[1]
Year_data[1:4]
Year_data[1:10]
for (i in length(files)){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
for (i in 1:length(files)){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
head_data
files[1]
for (i in 2:length(files)){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
head_data
files[76]
files[75]
files <- list.files(folder,pattern = "*.pdf",full.names = T)
for (i in 2:length(files)){
print(i)
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
head_data
file[104]
files[104]
pdf_info(files[104])
for (i in 2:length(files)){
print(i)
if(n==104) next
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
for (i in 2:length(files)){
print(i)
if(i==104) next
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
Year_data
which(is.na(Year_data)))
which(is.na(Year_data))
files[2]
data1 <- pdf_data(files[2])
data1[[1]]$text[1:30]
data1 <- pdf_data(files[104])
data1[[1]]$text[1:30]
files[104]
Year_data[1] <- 2021
Year_data[104] <- 2021
files[2]
files[104]
files[105]
which(is.na(Year_data))
Year_data
files[6]
files <- list.files(folder,pattern = "*.pdf",full.names = T)
for (i in 1:length(files)){
print(i)
if(i==104) next
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
for (i in 1:length(files)){
print(i)
if(i==104 | i==1) next
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
length(head_data)
length(Year_data)
length(files)
files[1]
files[104]
folder = "CDSC_Data/"
files <- list.files(folder,pattern = "*.pdf",full.names = T)
for (i in 1:length(files)){
print(i)
#if(i==104 | i==1) next
head_data <- pdf_data(files[i])[[1]]$text[1:30]
j = which(head_data == "Month" | head_data =="month")
Year_data[i] = head_data[j+3]
#print(pdf_data(files[i])[[1]]$text[1:15])
}
length(files)
length(Year_data)
Year_data
